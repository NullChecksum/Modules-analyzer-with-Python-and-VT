# DLL & EXE Runtime Analyzer + VirusTotal Integration

This project provides a complete system for analyzing modules (DLL, EXE) currently loaded in memory by Windows processes, with reputation verification via [VirusTotal](https://www.virustotal.com/).

---

##  Project Content

- `DLL.ps1`: PowerShell script for local analysis of running DLL/EXE
- `Analyze_dlls_vt_filtered.py`: Python script that filters suspicious modules and queries VirusTotal

---

## 🛡️ Purpose

This tool allows you to:

- Collect all DLLs and executables loaded by Windows processes
- Compute MD5 and SHA256 hashes of the files
- Verify size, publisher, version, and path
- Identify potentially suspicious modules based on static heuristics
- Query VirusTotal to check their online reputation

---

##  How It Works

### `DLL.ps1` (PowerShell)

**Main Features:**

- Requires execution as Administrator
- Analyzes all active processes (`Get-Process`)
- Extracts modules (`.Modules`), including `.dll`, `.exe`, `.ocx`, etc.
- For each module:
  - Calculates MD5 and SHA256 hashes
  - Retrieves:
    - File name
    - Path
    - Version
    - Publisher (Company)
    - Size
    - Last modified date
- Saves the result in `.json` format on the desktop

**Output:**

- `PCNAME_YYYYMMDD_HHMMSS_DllList.json`
- Includes any blocked or errored files

---

###  `analyze_dlls_vt_filtered.py` (Python)

**Main Features:**

- Loads the JSON file generated by PowerShell
- Applies rules to determine suspicious DLLs/EXEs:
  - Non-standard path
  - Missing digital signature
  - Missing or `0.0.0.0` version
  - Very small size
  - Unavailable hash
- For each suspicious module:
  - Queries VirusTotal using the public API (4 requests/minute)
  - Reports how many AV engines detect it
  - Provides a direct link to the VT report

**Output:**

- `VirusTotal_Sospetti_Report_YYYYMMDD_HHMMSS.txt`
- Contains filename, path, MD5, reasons for suspicion, and VT link

---

## 🧰 Requirements

> **IMPORTANT:** A VirusTotal API KEY is required

- PowerShell 5.1+ (included in Windows 10/11)
- Python 3.8+
- Python modules:

```
pip install requests
```
Example Ps1 output:

(Administrator powershell session)

powershell -ep bypass

.\DLL.ps1 

![{015DB8BE-5CB6-4599-B3C3-4981DD52CC71}](https://github.com/user-attachments/assets/d183a711-764d-43e1-9502-b21942634131)


Example python output:


python3 Analyze_dlls_vt_filtered.py  `PCNAME_YYYYMMDD_HHMMSS_DllList.json`

![image](https://github.com/user-attachments/assets/a9783770-e4f1-4d90-8490-7f03ee712a35)



